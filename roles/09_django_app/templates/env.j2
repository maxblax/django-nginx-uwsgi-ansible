# Django Environment Variables for {{ env_name }}
# {{ ansible_managed }}

# Django Settings
DJANGO_SETTINGS_MODULE=backend.settings.production
DEBUG=False
SECRET_KEY={{ django_secret_key_staging if env_name == 'staging' else django_secret_key_production }}

# CSRF Protection
ALLOWED_HOSTS={{ env_domain.domain }}{% if env_domain.additional_domains is defined and env_domain.additional_domains %},{{ env_domain.additional_domains | join(',') }}{% endif %}

CSRF_TRUSTED_ORIGINS=https://{{ env_domain.domain }}{% if env_domain.additional_domains is defined and env_domain.additional_domains %},https://{{ env_domain.additional_domains | join(',https://') }}{% endif %}

# Database Configuration
POSTGRES_HOST=172.17.0.1
POSTGRES_PORT=5432
POSTGRES_DB={{ project_config.services.postgresql.staging_db if env_name == 'staging' else project_config.services.postgresql.production_db }}
POSTGRES_USER={{ project_config.services.postgresql.staging_user if env_name == 'staging' else project_config.services.postgresql.production_user }}
POSTGRES_PASSWORD={{ postgres_staging_password if env_name == 'staging' else postgres_production_password }}

# Redis Configuration
REDIS_URL=redis://redis:6379/0

# Domain
DOMAIN={{ env_domain.domain }}

# Security Settings (HTTPS)
{% if project_config.ssl.enabled %}
SESSION_COOKIE_SECURE=True
CSRF_COOKIE_SECURE=True
{% else %}
SESSION_COOKIE_SECURE=False
CSRF_COOKIE_SECURE=False
{% endif %}

# JWT
JWT_SECRET_KEY={{ jwt_secret_key_staging if env_name == 'staging' else jwt_secret_key_production }}

# API Keys (optional)
{% if openai_api_key %}
OPENAI_API_KEY={{ openai_api_key }}
{% endif %}
{% if stripe_secret_key %}
STRIPE_SECRET_KEY={{ stripe_secret_key }}
{% endif %}
{% if stripe_webhook_secret %}
STRIPE_WEBHOOK_SECRET={{ stripe_webhook_secret }}
{% endif %}
{% if groq_api_key %}
GROQ_API_KEY={{ groq_api_key }}
{% endif %}
{% if google_client_id %}
GOOGLE_CLIENT_ID={{ google_client_id }}
{% endif %}
{% if google_client_secret %}
GOOGLE_CLIENT_SECRET={{ google_client_secret }}
{% endif %}

# Email Configuration
{% if email_host_user %}
EMAIL_HOST_USER={{ email_host_user }}
{% endif %}
{% if email_host_password %}
EMAIL_HOST_PASSWORD={{ email_host_password }}
{% endif %}

# Flower (Celery monitoring)
{% if env_services.flower[env_name].enabled %}
FLOWER_USERNAME={{ flower_username }}
FLOWER_PASSWORD={{ flower_password }}
{% endif %}
